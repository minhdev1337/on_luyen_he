<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Hệ thống bài tập hè</title>
    <style>
        /* --- General Styles --- */
        :root {
            --primary-blue: #007bff;
            --light-blue: #e7f3ff;
            --white: #ffffff;
            --dark-text: #333;
            --light-gray: #f8f9fa;
            --green: #28a745;
            --red: #dc3545;
            --yellow: #ffc107;
        }

        body {
            background-color: var(--light-gray);
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            margin: 0;
        }

        /* --- Lớp phủ chờ & Trang bắt đầu --- */
        #loader-overlay, #start-overlay, .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
        }

        #loader-overlay {
            background-color: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(5px);
        }
        .spinner { width: 60px; height: 60px; border: 8px solid #f3f3f3; border-top: 8px solid var(--primary-blue); border-radius: 50%; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        #start-overlay {
            background-color: var(--primary-blue);
            color: var(--white);
            flex-direction: column;
            text-align: center;
        }
        #start-overlay h1 { font-size: 42px; margin-bottom: 10px; }
        #start-overlay p { font-size: 20px; margin-bottom: 30px; opacity: 0.9; }
        #start-btn { font-size: 24px; padding: 15px 40px; background-color: var(--white); color: var(--primary-blue); font-weight: bold; border-radius: 12px; box-shadow: 0 4px 10px rgba(0,0,0,0.2); }

        /* --- Các lớp phủ khác (mặc định ẩn) --- */
        #break-overlay, #too-close-warning, .modal-overlay {
            display: none;
        }

        #break-overlay {
            background-color: rgba(0, 0, 0, 0.85);
            color: var(--white);
            flex-direction: column;
            text-align: center;
            z-index: 10002;
        }
        #break-overlay h2 { font-size: 36px; margin-bottom: 15px; }
        #break-countdown { font-size: 48px; font-weight: bold; background-color: var(--primary-blue); padding: 10px 30px; border-radius: 12px; }

        #too-close-warning {
            position: fixed;
            top: 20px; left: 50%;
            transform: translateX(-50%);
            background-color: var(--yellow);
            color: var(--dark-text);
            padding: 15px 25px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.25);
            font-size: 18px;
            font-weight: bold;
            z-index: 10001;
            text-align: center;
        }

        /* --- Các thành phần chính của ứng dụng --- */
        #app-wrapper {
            display: none;
            padding-top: 145px;
            padding-bottom: 60px; /* Khoảng trống cho footer */
        }
        .app-header { background-color: var(--primary-blue); color: var(--white); padding: 10px 20px; display: flex; align-items: center; position: fixed; top: 0; left: 0; width: 100%; z-index: 100; box-shadow: 0 2px 4px rgba(0,0,0,0.1); box-sizing: border-box; }
        .app-header .logo { width: 50px; height: 50px; margin-right: 15px; border-radius: 50%; flex-shrink: 0; }
        .title-wrapper { display: flex; flex-direction: column; }
        .app-header .title { font-size: 24px; font-weight: bold; margin: 0; }
        .app-header .slogan { font-size: 14px; font-style: italic; opacity: 0.9; margin: 2px 0 0 0; }
        .spacer { flex-grow: 1; }
        .user-greeting { font-size: 16px; font-weight: 500; white-space: nowrap; }
        .top-bar-container { width: 100%; background-color: var(--light-blue); padding: 8px 0; position: fixed; top: 78px; left: 0; z-index: 99; display: flex; align-items: center; justify-content: space-between; box-sizing: border-box; padding-left: 5%; padding-right: 5%; }
        .progress-wrapper { flex-grow: 1; margin-right: 20px; }
        .progress-bar { background-color: var(--white); border: 1px solid #cce5ff; border-radius: 8px; height: 20px; overflow: hidden; }
        #progress-fill { width: 0%; height: 100%; background-color: var(--primary-blue); border-radius: 6px; transition: width 0.4s ease-in-out; }
        #progress-text { text-align: left; margin-top: 4px; color: var(--dark-text); font-weight: bold; font-size: 20px; }
        .timer-wrapper { background-color: var(--white); color: var(--dark-text); font-size: 18px; font-weight: bold; padding: 5px 15px; border-radius: 8px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); white-space: nowrap; }
        .quiz-section, #results-container { text-align: center; max-width: 800px; margin: 15px auto; }
        #question-container, .results-box { background-color: var(--white); padding: 25px 30px; border-radius: 8px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
        #question-container h2, .results-box h2 { color: var(--dark-text); font-size: 24px; margin-bottom: 25px;}
        .btn-group { display: flex; justify-content: center; gap: 20px; margin-top: 20px; }
        button { background-color: var(--primary-blue); color: var(--white); font-size: 20px; padding: 10px 24px; border: none; border-radius: 8px; cursor: pointer; transition: background-color 0.2s; }
        button:hover { background-color: #0056b3; }
        button:disabled { background-color: #a1a1a1; cursor: not-allowed; opacity: 0.7; }
        #results-container { display: none; margin-top: 0; }
        #final-score { font-size: 28px; font-weight: bold; margin: 15px 0 5px 0; }
        #final-correct-count { font-size: 18px; margin-bottom: 15px; }
        #final-time { font-size: 16px; color: #6c757d; }
        #final-violations { font-size: 16px; color: var(--red); margin-bottom: 25px; }
        #restart-btn { font-size: 18px; padding: 10px 28px; }
        .score-green { color: var(--green); } .score-red { color: var(--red); } .score-yellow { color: var(--yellow); }
        #wrong-answers-container { margin-top: 30px; text-align: left; }
        #wrong-answers-container h3 { border-bottom: 2px solid #eee; padding-bottom: 10px; }
        .wrong-answer-item { margin-bottom: 15px; padding-left: 15px; border-left: 4px solid var(--red); }
        .wrong-answer-q { font-weight: bold; } .user-answer { color: var(--red); } .correct-answer { color: var(--green); }
        .video-container { position: fixed; bottom: 15px; right: 15px; width: 280px; height: 210px; border-radius: 10px; overflow: hidden; border: 2px solid #ccc; z-index: 1001; }
        .video-container video, .video-container canvas { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }
        .options-container { display: inline-flex; flex-direction: column; align-items: flex-start; }
        .answer-option { display: flex; align-items: center; margin: 8px 0; font-size: 18px; cursor: pointer; }
        .answer-option label { padding-left: 12px; }
        #question-container input[type="radio"] { width: 18px; height: 18px; }
        #short-answer { width: 80%; max-width: 500px; padding: 12px; font-size: 18px; border: 1px solid #ccc; border-radius: 12px; text-align: center; margin-top: 15px; }
        #menu-btn { position: fixed; bottom: 5px; left: 15px; width: 50px; height: 50px; background-color: var(--primary-blue); border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer; z-index: 1001; box-shadow: 0 2px 5px rgba(0,0,0,0.2); font-size: 24px; color: white; }
        .modal-overlay { background-color: rgba(0, 0, 0, 0.6); z-index: 1002; }
        .modal-content { background-color: var(--white); padding: 30px 40px; border-radius: 12px; text-align: center; display: flex; gap: 20px; }
        .resume-box { background-color: var(--white); padding: 40px 60px; border-radius: 16px; box-shadow: 0 5px 20px rgba(0,0,0,0.25); }
        #resume-btn { font-size: 24px; padding: 20px 40px; }
        .app-footer {
           position: fixed; /* Làm cho nó cố định */
           bottom: 0;
           left: 0;
           width: 100%;
           text-align: center;
           padding: 10px 0; /* Giảm padding để thấp hơn */
           background-color: var(--light-gray);
           color: #6c757d;
           font-size: 12px;
           border-top: 1px solid #dee2e6;
           z-index: 1000; /* Đảm bảo nó nằm trên nội dung nhưng dưới các nút */
        }
        .app-footer p { margin: 2px 0; }
    </style>
    <link rel="icon" href="logo.png">
</head>
<body>
    <div id="loader-overlay"><div class="spinner"></div></div>

    <div id="start-overlay">
        <h1>Hệ thống ôn luyện hè</h1>
        <p>Nhấn nút bên dưới để bắt đầu làm bài.</p>
        <button id="start-btn">Bắt đầu</button>
    </div>

    <div id="break-overlay" class="modal-overlay">
        <h2>Đã đến giờ nghỉ!</h2>
        <div id="break-countdown">05:00</div>
    </div>

    <div id="too-close-warning">
        Bạn đang cúi quá sát màn hình. Vui lòng để mặt ra xa!
    </div>

    <div id="app-wrapper" style="display: none;">
        <header class="app-header">
            <img src="logo.png" alt="Logo" class="logo">
            <div class="title-wrapper">
                <h1 class="title">Hệ thống ôn luyện hè</h1>
                <p class="slogan">Cố lên, cố lên, sắp tới rồi, sắp tới rồi !</p>
            </div>
            <div class="spacer"></div>
            <div class="user-greeting">Xin chào, Trịnh Hoàng Lâm</div>
        </header>

        <div class="top-bar-container">
            <div class="progress-wrapper">
                <div class="progress-bar"><div id="progress-fill"></div></div>
                <div id="progress-text">Câu 1/3</div>
            </div>
            <div class="timer-wrapper">Thời gian: <span id="timer">00:00</span></div>
        </div>

        <main id="quiz-section" class="quiz-section">
            <div id="question-container"></div>
            <div class="btn-group">
                <button id="prev-btn">Câu trước</button>
                <button id="next-submit-btn">Câu tiếp</button>
            </div>
        </main>
        
        <div id="results-container">
            <div class="results-box">
                <h2>Hoàn thành!</h2>
                <div id="final-score"></div>
                <div id="final-correct-count"></div>
                <div id="final-time"></div>
                <div id="final-violations"></div>
                <button id="restart-btn">Làm lại bài</button>
                <div id="wrong-answers-container"></div>
            </div>
        </div>

        <div class="video-container">
            <video id="webcam" autoplay muted playsinline></video>
            <canvas id="overlay"></canvas>
        </div>

        <button id="menu-btn">☰</button>

        <div id="pause-modal" class="modal-overlay">
            <div class="modal-content">
                <button id="pause-btn">Tạm ngừng</button>
                <button id="exit-btn">Thoát</button>
            </div>
        </div>
        
        <div id="resume-overlay" class="modal-overlay">
            <div class="resume-box"><button id="resume-btn">Tiếp tục làm bài</button></div>
        </div>
        
        <footer class="app-footer">
            <p>Bản quyền thuộc về Trịnh Hoàng Minh</p>
            <p>Copyright © 2025. Powered by ChatGPT and Gemini</p>
        </footer>
    </div>
    
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/face_mesh/face_mesh.js" crossorigin="anonymous"></script>
    <script src="script.js"></script>
</body>
</html>